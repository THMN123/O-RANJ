<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#4361ee">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="O-RANJ">
    <meta name="description" content="Offline survey app for field data collection">
    <meta name="keywords" content="survey, data collection, offline, pwa">
    <title>O-RANJ</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="images/photo1.png">
    <link rel="apple-touch-icon" href="images/photo1.png">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #eb8731;
            --secondary: #eb8731;
            --accent: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4bb543;
            --warning: #ffcc00;
            --danger: #dc3545;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        body.standalone {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        /* PWA Installation Prompt */
        .install-prompt {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            border-left: 4px solid #eb8731;
        }
        
        .install-prompt button {
            margin: 5px;
            padding: 8px 15px;
        }
        
        /* Offline Indicator */
        .offline-indicator {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #eb8731;
            color: white;
            text-align: center;
            padding: 8px;
            z-index: 1001;
        }
        
        /* Sync Status */
        .sync-status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 999;
        }
        
        .app-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }
        
        .nav-btn {
            padding: 12px 25px;
            background-color: white;
            border: 2px solid var(--primary);
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            min-height: 44px;
        }
        
        .nav-btn.active {
            background-color: var(--primary);
            color: white;
        }
        
        .nav-btn:hover:not(.active) {
            background-color: #f0f0f0;
        }
        
        .app-section {
            display: none;
        }
        
        .app-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Survey Styles */
        .progress-container {
            margin: 30px 0;
            background-color: #e9ecef;
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, var(--accent), var(--primary));
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .survey-section {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: none;
        }
        
        .survey-section.active {
            display: block;
        }
        
        .question {
            margin-bottom: 25px;
        }
        
        .question-text {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        textarea, input[type="text"], input[type="email"], input[type="tel"] {
            width: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            resize: vertical;
        }
        
        textarea {
            min-height: 100px;
        }
        
        .rating-scale {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .rating-option {
            text-align: center;
            flex: 1;
            padding: 15px 10px;
            margin: 0 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .rating-option:hover {
            background-color: #f0f0f0;
        }
        
        .rating-option.selected {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .ranking-container {
            margin-top: 10px;
        }
        
        .ranking-item {
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ranking-item.dragging {
            opacity: 0.5;
        }
        
        .ranking-controls {
            display: flex;
            gap: 10px;
        }
        
        .ranking-controls button {
            padding: 5px 10px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .options-list {
            margin-top: 10px;
        }
        
        .option-item {
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 44px;
        }
        
        .option-item:hover {
            background-color: #f0f0f0;
        }
        
        .option-item.selected {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .btn-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 10px;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 44px;
        }
        
        .btn-prev {
            background-color: #e9ecef;
            color: var(--dark);
        }
        
        .btn-prev:hover {
            background-color: #dee2e6;
        }
        
        .btn-next, .btn-submit {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-next:hover, .btn-submit:hover {
            background-color: var(--secondary);
        }
        
        .btn-next:disabled {
            background-color: #adb5bd;
            cursor: not-allowed;
        }
        
        .section-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .section-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #dee2e6;
            margin: 0 5px;
        }
        
        .section-dot.active {
            background-color: var(--primary);
        }
        
        .thank-you {
            text-align: center;
            padding: 50px 20px;
            display: none;
        }
        
        .thank-you h2 {
            color: var(--success);
            margin-bottom: 20px;
        }
        
        /* Dashboard Styles */
        .dashboard-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
            font-size: 0.9rem;
        }
        
        .export-btn {
            padding: 10px 20px;
            background-color: var(--success);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            min-height: 44px;
        }
        
        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .chart-wrapper {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .data-table {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .insights-panel {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        
        .insight-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .insight-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .insight-title {
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .insight-content {
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            min-height: 44px;
            display: flex;
            align-items: center;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Team Panel Styles */
        .team-panel {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .panel-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
        }
        
        .team-member {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .role {
            color: #666;
            font-size: 0.9em;
        }
        
        /* Notification animations */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            color: white;
            padding: 15px;
            border-radius: 5px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .survey-section {
                padding: 20px 15px;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            .chart-wrapper {
                height: 250px;
            }
            
            .rating-scale {
                flex-direction: column;
            }
            
            .rating-option {
                margin: 5px 0;
            }
            
            .btn-container {
                flex-direction: column;
            }
            
            .btn-container button {
                width: 100%;
                margin: 5px 0;
            }
            
            .data-table {
                padding: 10px;
                font-size: 14px;
            }
            
            th, td {
                padding: 8px 10px;
            }
            
            .filter-group {
                flex-direction: column;
                width: 100%;
            }
            
            .filter-select {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .stats-overview {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .install-prompt {
                bottom: 80px;
            }
            
            .sync-status {
                top: env(safe-area-inset-top);
                right: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .stats-overview {
                grid-template-columns: 1fr;
            }
            
            .chart-wrapper {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offline-indicator">
        ‚ö†Ô∏è You are currently offline
    </div>
    
    <!-- Sync Status -->
    <div class="sync-status" id="sync-status">
        üíæ All data saved locally
    </div>
    
    <!-- Install Prompt -->
    <div class="install-prompt" id="install-prompt">
        <p>Install Survey App for better experience?</p>
        <button id="install-btn">Install</button>
        <button id="cancel-install">Not Now</button>
    </div>

    <div class="container">
        <header>
            <h1>Field Survey App</h1>
            <p class="subtitle">Collect and analyze survey data offline in the field</p>
        </header>
        
        <div class="app-nav">
            <button class="nav-btn active" data-section="survey">Take Survey</button>
            <button class="nav-btn" data-section="dashboard">View Results</button>
        </div>
        
        <!-- Survey Section -->
        <section class="app-section active" id="survey-section">
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            
            <div class="section-indicator" id="section-indicator">
                <!-- Section dots will be added by JavaScript -->
            </div>
            
            <!-- Section 1: Identifying the Biggest Problems -->
            <section class="survey-section active" id="section-1">
                <h2>Identifying the Biggest Problems</h2>
                
                <div class="question">
                    <p class="question-text">What's the most annoying thing about being a student right now?</p>
                    <textarea id="open-ended-problem" placeholder="Share your thoughts..."></textarea>
                </div>
                
                <div class="question">
                    <p class="question-text">On a scale of 1-5, how big of a problem are these in your life?</p>
                    
                    <div id="problem-ratings">
                        <!-- Problem ratings will be generated by JavaScript -->
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-text">Rank the TOP 3 problems you'd most want solved for you as a student:</p>
                    <div class="ranking-container" id="problem-ranking">
                        <!-- Ranking items will be generated by JavaScript -->
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn-prev" disabled>Previous</button>
                    <button class="btn-next" id="next-1">Next</button>
                </div>
            </section>
            
            <!-- Section 2: Current Solutions & Gaps -->
            <section class="survey-section" id="section-2">
                <h2>Current Solutions & Gaps</h2>
                
                <div class="question">
                    <p class="question-text">How do you currently try to solve <span id="top-problem-text">your top problem</span>?</p>
                    <textarea id="current-solution" placeholder="Describe your current approach..."></textarea>
                </div>
                
                <div class="question">
                    <p class="question-text">How satisfied are you with your current solution?</p>
                    <div class="rating-scale" id="satisfaction-rating">
                        <div class="rating-option" data-value="1">1 (Very Dissatisfied)</div>
                        <div class="rating-option" data-value="2">2</div>
                        <div class="rating-option" data-value="3">3 (Neutral)</div>
                        <div class="rating-option" data-value="4">4</div>
                        <div class="rating-option" data-value="5">5 (Very Satisfied)</div>
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-text">What's the most frustrating thing about how you currently solve this?</p>
                    <div class="options-list" id="frustration-options">
                        <!-- Options will be generated by JavaScript -->
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn-prev" id="prev-2">Previous</button>
                    <button class="btn-next" id="next-2">Next</button>
                </div>
            </section>
            
            <!-- Section 3: Product Discovery -->
            <section class="survey-section" id="section-3">
                <h2>Product Discovery</h2>
                
                <div class="question">
                    <p class="question-text">If you could get a brand new service tomorrow to solve your problem, which excites you most?</p>
                    <div class="options-list" id="solution-options">
                        <!-- Solution options will be generated by JavaScript -->
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-text">How likely would you be to use this solution?</p>
                    <div class="rating-scale" id="likelihood-rating">
                        <div class="rating-option" data-value="1">1 (Very Unlikely)</div>
                        <div class="rating-option" data-value="2">2</div>
                        <div class="rating-option" data-value="3">3 (Neutral)</div>
                        <div class="rating-option" data-value="4">4</div>
                        <div class="rating-option" data-value="5">5 (Very Likely)</div>
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-text">How much would you be willing to pay for it (per week)?</p>
                    <div class="options-list" id="pricing-options">
                        <!-- Pricing options will be generated by JavaScript -->
                    </div>
                </div>
                
                <div class="question">
                    <p class="question-text">Would you try it even if none of your friends used it yet?</p>
                    <div class="options-list">
                        <div class="option-item" data-value="yes">Yes</div>
                        <div class="option-item" data-value="no">No</div>
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn-prev" id="prev-3">Previous</button>
                    <button class="btn-next" id="next-3">Next</button>
                </div>
            </section>
            
            <!-- Section 4: Wrap-Up -->
            <section class="survey-section" id="section-4">
                <h2>Wrap-Up</h2>
                
                <div class="question">
                    <p class="question-text">If student life was a video game, what boss battle are you stuck on right now?</p>
                    <textarea id="boss-battle" placeholder="Be creative!"></textarea>
                </div>
                
                <div class="question">
                    <p class="question-text">Want to be one of the first to try out solutions we're building?</p>
                    <div class="options-list">
                        <div class="option-item" data-value="yes">Yes, I'm interested!</div>
                        <div class="option-item" data-value="no">No, thanks</div>
                    </div>
                </div>
                
                <div class="question" id="contact-info" style="display: none;">
                    <p class="question-text">Great! How can we contact you?</p>
                    <input type="email" id="email" placeholder="Email address" style="margin-bottom: 10px;">
                    <input type="tel" id="phone" placeholder="Phone number (optional)">
                </div>
                
                <div class="btn-container">
                    <button class="btn-prev" id="prev-4">Previous</button>
                    <button class="btn-submit" id="submit">Submit Survey</button>
                </div>
            </section>
            
            <!-- Thank You Message -->
            <div class="thank-you" id="thank-you">
                <h2>Thank You!</h2>
                <p>Your responses have been recorded. We appreciate your time and insights!</p>
                <button class="nav-btn" id="view-results" style="margin-top: 20px;">View Results</button>
            </div>
        </section>
        
        <!-- Dashboard Section -->
        <section class="app-section" id="dashboard-section">
            <div class="dashboard-controls">
                <div class="filter-group">
                    <select class="filter-select" id="time-filter">
                        <option value="all">All Time</option>
                        <option value="week">Last Week</option>
                        <option value="month">Last Month</option>
                        <option value="quarter">Last Quarter</option>
                    </select>
                    
                    <select class="filter-select" id="problem-filter">
                        <option value="all">All Problems</option>
                        <option value="food">Food/Nutrition</option>
                        <option value="money">Money/Expenses</option>
                        <option value="transport">Transport</option>
                        <option value="academics">Academics</option>
                        <option value="mental-health">Mental Health</option>
                    </select>
                </div>
                
                <button class="export-btn" id="export-data">
                    <span>Export Data</span>
                </button>
            </div>
            
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-value" id="total-responses">0</div>
                    <div class="stat-label">Total Responses</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-value" id="completion-rate">0%</div>
                    <div class="stat-label">Completion Rate</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-value" id="avg-problem-severity">0.0</div>
                    <div class="stat-label">Avg Problem Severity</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-value" id="top-problem">-</div>
                    <div class="stat-label">Top Problem Area</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-value" id="solution-interest">0%</div>
                    <div class="stat-label">Solution Interest</div>
                </div>
            </div>
            
            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" data-tab="overview">Overview</div>
                    <div class="tab" data-tab="problems">Problem Analysis</div>
                    <div class="tab" data-tab="solutions">Solution Analysis</div>
                </div>
                
                <!-- Overview Tab -->
                <div class="tab-content active" id="overview-tab">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Problem Distribution</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="problem-distribution-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Top Problem Areas</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="top-problems-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Problem Severity by Category</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="severity-by-category-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Preferred Solutions</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="preferred-solutions-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insights-panel">
                        <h3>Key Insights</h3>
                        <div class="insight-item">
                            <div class="insight-title">
                                <span>üìä</span>
                                <span>Most Pressing Issue</span>
                            </div>
                            <div class="insight-content" id="most-pressing-insight">
                                No data yet. Collect some survey responses to see insights.
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <div class="insight-title">
                                <span>üí∞</span>
                                <span>Willingness to Pay</span>
                            </div>
                            <div class="insight-content" id="willingness-pay-insight">
                                No data yet. Collect some survey responses to see insights.
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <div class="insight-title">
                                <span>üöÄ</span>
                                <span>Early Adopter Potential</span>
                            </div>
                            <div class="insight-content" id="early-adopter-insight">
                                No data yet. Collect some survey responses to see insights.
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Problem Analysis Tab -->
                <div class="tab-content" id="problems-tab">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Current Solution Satisfaction</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="satisfaction-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Frustration Factors</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="frustration-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Solution Analysis Tab -->
                <div class="tab-content" id="solutions-tab">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Solution Adoption Likelihood</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="adoption-likelihood-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Willingness to Pay</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="willingness-pay-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">Early Adopter Analysis</div>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="early-adopter-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="data-table">
                <h3>Response Data</h3>
                <table id="response-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Date</th>
                            <th>Top Problem</th>
                            <th>Severity</th>
                            <th>Preferred Solution</th>
                            <th>Willingness to Pay</th>
                            <th>Early Adopter</th>
                        </tr>
                    </thead>
                    <tbody id="response-table-body">
                        <!-- Table rows will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <script>
        // Application state
        let currentSection = 1;
        const totalSections = 4;
        let currentAppSection = 'survey';
        
        // Survey data templates
        const surveyData = {
            problemCategories: [
                "Money/expenses",
                "Food/nutrition",
                "Clothing",
                "Transport",
                "Academics/study support",
                "Mental health/wellbeing",
                "Social life/connections",
                "Opportunities (jobs/internships/events)",
                "Housing/accommodation",
                "Safety/security"
            ],
            frustrationOptions: [
                "Too expensive",
                "Not reliable",
                "Time-consuming",
                "Not available when I need it",
                "Doesn't really solve the problem"
            ],
            solutionOptions: [
                "Cheaper healthy food delivery on campus",
                "Student ride-sharing & transport coordination",
                "Study/notes marketplace & tutoring platform",
                "Mental health/wellness support",
                "Quick side hustles & job matching",
                "Campus social hub (events, networking, fun)",
                "Housing marketplace",
                "Safety alert & buddy system"
            ],
            pricingOptions: [
                "Up to R30 per week",
                "Up to R80 per week",
                "Up to R150 per week",
                "More, if it really works"
            ]
        };

        // Team and survey management
        const TeamApp = {
            currentSurvey: null,
            teamMembers: [],
            
            init() {
                this.loadTeamData();
                this.setupTeamFeatures();
                this.setupNotifications();
            },
            
            loadTeamData() {
                // Load team members and surveys from localStorage
                this.teamMembers = JSON.parse(localStorage.getItem('teamMembers') || '[]');
                this.surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
                
                if (this.teamMembers.length === 0) {
                    // Initialize with current user as team lead
                    this.teamMembers = [{
                        id: this.generateId(),
                        name: 'Team Lead',
                        role: 'lead',
                        joined: new Date().toISOString()
                    }];
                    this.saveTeamData();
                }
            },
            
            setupTeamFeatures() {
                // Add team management UI
                this.createTeamPanel();
                this.setupSurveySharing();
            },
            
            createTeamPanel() {
                const header = document.querySelector('header');
                const teamBtn = document.createElement('button');
                teamBtn.textContent = `üë• Team (${this.teamMembers.length})`;
                teamBtn.className = 'nav-btn';
                teamBtn.style.marginLeft = '10px';
                teamBtn.addEventListener('click', () => this.showTeamPanel());
                
                header.appendChild(teamBtn);
            },
            
            showTeamPanel() {
                const panel = document.createElement('div');
                panel.className = 'team-panel';
                panel.innerHTML = `
                    <div class="panel-content">
                        <h3>Team Management</h3>
                        <div class="team-list">
                            ${this.teamMembers.map(member => `
                                <div class="team-member">
                                    <span>${member.name}</span>
                                    <span class="role">${member.role}</span>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="TeamApp.exportTeamData()">Export All Data</button>
                        <button onclick="TeamApp.syncWithTeam()">Sync With Team</button>
                        <button onclick="this.parentElement.parentElement.remove()">Close</button>
                    </div>
                `;
                
                document.body.appendChild(panel);
            },
            
            exportTeamData() {
                const allData = {
                    team: this.teamMembers,
                    surveys: this.surveys,
                    responses: JSON.parse(localStorage.getItem('surveyResponses') || '[]'),
                    timestamp: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(allData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `survey-data-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showNotification('Data exported successfully', 'success');
            },
            
            syncWithTeam() {
                // This would sync with other team members' devices
                // For now, we'll just show a notification
                if (navigator.onLine) {
                    this.showNotification('Looking for team devices...', 'info');
                } else {
                    this.showNotification('Need internet connection for team sync', 'error');
                }
            },
            
            setupNotifications() {
                // Request notification permission
                if ('Notification' in window && Notification.permission === 'default') {
                    Notification.requestPermission();
                }
            },
            
            showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'success' ? '#4bb543' : type === 'error' ? '#dc3545' : '#4361ee'};
                    color: white;
                    padding: 15px;
                    border-radius: 5px;
                    z-index: 1000;
                    animation: slideIn 0.3s ease;
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            },
            
            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            },
            
            saveTeamData() {
                localStorage.setItem('teamMembers', JSON.stringify(this.teamMembers));
                localStorage.setItem('surveys', JSON.stringify(this.surveys));
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeSurvey();
            setupEventListeners();
            TeamApp.init();
            loadDashboard();
            
            // Check if app is installed
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('App is running in standalone mode');
                document.body.classList.add('standalone');
            }
            
            // Service Worker Registration
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(error) {
                        console.log('ServiceWorker registration failed: ', error);
                        // Show user-friendly message
                        TeamApp.showNotification('Offline features not available', 'warning');
                    });
            }
        });

        function initializeSurvey() {
            // Create section indicators
            const sectionIndicator = document.getElementById('section-indicator');
            for (let i = 1; i <= totalSections; i++) {
                const dot = document.createElement('div');
                dot.className = `section-dot ${i === 1 ? 'active' : ''}`;
                dot.dataset.section = i;
                sectionIndicator.appendChild(dot);
            }

            // Generate problem ratings
            const problemRatingsContainer = document.getElementById('problem-ratings');
            surveyData.problemCategories.forEach(category => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                const questionText = document.createElement('p');
                questionText.className = 'question-text';
                questionText.textContent = category;
                questionDiv.appendChild(questionText);
                
                const ratingScale = document.createElement('div');
                ratingScale.className = 'rating-scale';
                
                for (let i = 1; i <= 5; i++) {
                    const ratingOption = document.createElement('div');
                    ratingOption.className = 'rating-option';
                    ratingOption.dataset.category = category;
                    ratingOption.dataset.value = i;
                    ratingOption.textContent = i;
                    ratingScale.appendChild(ratingOption);
                }
                
                questionDiv.appendChild(ratingScale);
                problemRatingsContainer.appendChild(questionDiv);
            });

            // Generate ranking items with touch controls
            const rankingContainer = document.getElementById('problem-ranking');
            surveyData.problemCategories.forEach((category, index) => {
                const rankingItem = document.createElement('div');
                rankingItem.className = 'ranking-item';
                rankingItem.textContent = category;
                rankingItem.dataset.category = category;
                rankingItem.dataset.value = index + 1;
                
                // Add touch-friendly controls
                const controls = document.createElement('div');
                controls.className = 'ranking-controls';
                
                const upBtn = document.createElement('button');
                upBtn.textContent = '‚Üë';
                upBtn.addEventListener('click', () => moveItemUp(category));
                
                const downBtn = document.createElement('button');
                downBtn.textContent = '‚Üì';
                downBtn.addEventListener('click', () => moveItemDown(category));
                
                controls.appendChild(upBtn);
                controls.appendChild(downBtn);
                rankingItem.appendChild(controls);
                
                rankingContainer.appendChild(rankingItem);
            });

            // Generate frustration options
            const frustrationContainer = document.getElementById('frustration-options');
            surveyData.frustrationOptions.forEach(option => {
                const optionItem = document.createElement('div');
                optionItem.className = 'option-item';
                optionItem.textContent = option;
                optionItem.dataset.value = option;
                frustrationContainer.appendChild(optionItem);
            });

            // Generate solution options
            const solutionContainer = document.getElementById('solution-options');
            surveyData.solutionOptions.forEach(option => {
                const optionItem = document.createElement('div');
                optionItem.className = 'option-item';
                optionItem.textContent = option;
                optionItem.dataset.value = option;
                solutionContainer.appendChild(optionItem);
            });

            // Generate pricing options
            const pricingContainer = document.getElementById('pricing-options');
            surveyData.pricingOptions.forEach(option => {
                const optionItem = document.createElement('div');
                optionItem.className = 'option-item';
                optionItem.textContent = option;
                optionItem.dataset.value = option;
                pricingContainer.appendChild(optionItem);
            });
        }

        function moveItemUp(category) {
            const items = Array.from(document.querySelectorAll('.ranking-item'));
            const currentIndex = items.findIndex(item => item.dataset.category === category);
            
            if (currentIndex > 0) {
                const container = document.getElementById('problem-ranking');
                const previousItem = items[currentIndex - 1];
                const currentItem = items[currentIndex];
                
                container.insertBefore(currentItem, previousItem);
            }
        }

        function moveItemDown(category) {
            const items = Array.from(document.querySelectorAll('.ranking-item'));
            const currentIndex = items.findIndex(item => item.dataset.category === category);
            
            if (currentIndex < items.length - 1) {
                const container = document.getElementById('problem-ranking');
                const nextItem = items[currentIndex + 1];
                const currentItem = items[currentIndex];
                
                container.insertBefore(currentItem, nextItem.nextSibling);
            }
        }

        function setupEventListeners() {
            // Navigation between survey and dashboard
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const section = this.dataset.section;
                    switchAppSection(section);
                });
            });
            
            // Survey navigation buttons
            document.getElementById('next-1').addEventListener('click', () => navigateToSection(2));
            document.getElementById('next-2').addEventListener('click', () => navigateToSection(3));
            document.getElementById('next-3').addEventListener('click', () => navigateToSection(4));
            
            document.getElementById('prev-2').addEventListener('click', () => navigateToSection(1));
            document.getElementById('prev-3').addEventListener('click', () => navigateToSection(2));
            document.getElementById('prev-4').addEventListener('click', () => navigateToSection(3));
            
            document.getElementById('submit').addEventListener('click', submitSurvey);
            document.getElementById('view-results').addEventListener('click', () => switchAppSection('dashboard'));
            
            // Rating scale selection
            document.querySelectorAll('.rating-scale').forEach(scale => {
                scale.addEventListener('click', function(e) {
                    if (e.target.classList.contains('rating-option')) {
                        // Deselect all options in this scale
                        const siblings = Array.from(e.target.parentNode.children);
                        siblings.forEach(sibling => sibling.classList.remove('selected'));
                        
                        // Select the clicked option
                        e.target.classList.add('selected');
                    }
                });
            });
            
            // Option selection
            document.querySelectorAll('.options-list').forEach(list => {
                list.addEventListener('click', function(e) {
                    if (e.target.classList.contains('option-item')) {
                        // For single selection lists
                        if (!e.target.parentNode.classList.contains('multi-select')) {
                            const siblings = Array.from(e.target.parentNode.children);
                            siblings.forEach(sibling => sibling.classList.remove('selected'));
                        }
                        
                        // Toggle selection
                        e.target.classList.toggle('selected');
                        
                        // Show contact info if "Yes" is selected in section 4
                        if (currentSection === 4 && 
                            e.target.textContent.includes("Yes, I'm interested!")) {
                            document.getElementById('contact-info').style.display = 'block';
                        } else if (currentSection === 4 && 
                                   e.target.textContent.includes("No, thanks")) {
                            document.getElementById('contact-info').style.display = 'none';
                        }
                    }
                });
            });
            
            // Dashboard tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update active tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Export button
            document.getElementById('export-data').addEventListener('click', exportData);
            
            // PWA Installation Prompt
            let deferredPrompt;
            const installPrompt = document.getElementById('install-prompt');
            const installBtn = document.getElementById('install-btn');
            const cancelInstall = document.getElementById('cancel-install');

            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                installPrompt.style.display = 'block';
            });

            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    if (outcome === 'accepted') {
                        installPrompt.style.display = 'none';
                        deferredPrompt = null;
                    }
                }
            });

            cancelInstall.addEventListener('click', () => {
                installPrompt.style.display = 'none';
            });
            
            // Online/Offline Detection
            window.addEventListener('online', function() {
                document.getElementById('offline-indicator').style.display = 'none';
                document.getElementById('sync-status').textContent = '‚úÖ Online - All data saved';
            });

            window.addEventListener('offline', function() {
                document.getElementById('offline-indicator').style.display = 'block';
                document.getElementById('sync-status').textContent = 'üì± Offline - Saving locally';
            });
            
            // Prevent double-tap zoom on buttons
            document.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('touchstart', function(e) {
                    if (e.touches.length > 1) {
                        e.preventDefault();
                    }
                }, { passive: false });
            });
            
            // Better touch feedback
            document.querySelectorAll('.rating-option, .option-item').forEach(item => {
                item.addEventListener('touchstart', function() {
                    this.style.backgroundColor = '#e9ecef';
                });
                
                item.addEventListener('touchend', function() {
                    this.style.backgroundColor = '';
                });
            });
            
            // Handle orientation changes
            window.addEventListener('orientationchange', function() {
                // Redraw charts on orientation change
                setTimeout(loadDashboard, 300);
            });
        }

        function switchAppSection(section) {
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.section === section) {
                    btn.classList.add('active');
                }
            });
            
            // Update sections
            document.querySelectorAll('.app-section').forEach(sec => {
                sec.classList.remove('active');
            });
            document.getElementById(`${section}-section`).classList.add('active');
            
            currentAppSection = section;
            
            // If switching to dashboard, reload the data
            if (section === 'dashboard') {
                loadDashboard();
            }
        }

        function navigateToSection(sectionNumber) {
            // Validate current section before proceeding
            if (!validateCurrentSection()) {
                return;
            }
            
            // Hide current section
            document.getElementById(`section-${currentSection}`).classList.remove('active');
            
            // Update section indicator
            document.querySelectorAll('.section-dot').forEach(dot => {
                dot.classList.remove('active');
            });
            document.querySelector(`.section-dot[data-section="${sectionNumber}"]`).classList.add('active');
            
            // Show new section
            document.getElementById(`section-${sectionNumber}`).classList.add('active');
            
            // Update progress bar
            const progress = (sectionNumber / totalSections) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            
            // Update current section
            currentSection = sectionNumber;
            
            // Update top problem text in section 2 if needed
            if (sectionNumber === 2) {
                updateTopProblemText();
            }
        }

        function validateCurrentSection() {
            switch (currentSection) {
                case 1:
                    return validateSection1();
                case 2:
                    return validateSection2();
                case 3:
                    return validateSection3();
                case 4:
                    return validateSection4();
                default:
                    return true;
            }
        }

        function validateSection1() {
            const hasRatings = document.querySelectorAll('#problem-ratings .rating-option.selected').length > 0;
            if (!hasRatings) {
                alert('Please rate at least one problem before proceeding.');
                return false;
            }
            return true;
        }

        function validateSection2() {
            return true;
        }

        function validateSection3() {
            return true;
        }

        function validateSection4() {
            return true;
        }

        function updateTopProblemText() {
            // In a real implementation, you would get the top ranked problem
            // For this demo, we'll just use a placeholder
            document.getElementById('top-problem-text').textContent = "your top problem";
        }

        function submitSurvey() {
            // Collect survey data
            const surveyResponse = collectSurveyData();
            
            // Add team metadata
            surveyResponse.collectedBy = TeamApp.teamMembers[0]?.name || 'Unknown Collector';
            surveyResponse.deviceId = localStorage.getItem('deviceId') || TeamApp.generateId();
            surveyResponse.teamId = 'team-' + TeamApp.generateId();
            
            // Save to local storage
            saveSurveyResponse(surveyResponse);
            
            // Show success message
            TeamApp.showNotification('Survey submitted successfully!', 'success');
            
            // Show thank you message
            document.querySelectorAll('.survey-section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById('thank-you').style.display = 'block';
            document.getElementById('progress-bar').style.width = '100%';
            
            // Vibrate on success (if available)
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
        }

        function collectSurveyData() {
            const response = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                // Section 1
                openEndedProblem: document.getElementById('open-ended-problem').value,
                problemRatings: {},
                problemRanking: [],
                
                // Section 2
                currentSolution: document.getElementById('current-solution').value,
                satisfactionRating: document.querySelector('#satisfaction-rating .rating-option.selected')?.dataset.value,
                frustrationFactors: Array.from(document.querySelectorAll('#frustration-options .option-item.selected')).map(item => item.dataset.value),
                
                // Section 3
                preferredSolution: document.querySelector('#solution-options .option-item.selected')?.dataset.value,
                likelihoodRating: document.querySelector('#likelihood-rating .rating-option.selected')?.dataset.value,
                pricingOption: document.querySelector('#pricing-options .option-item.selected')?.dataset.value,
                tryWithoutFriends: document.querySelector('#section-3 .options-list .option-item.selected')?.dataset.value,
                
                // Section 4
                bossBattle: document.getElementById('boss-battle').value,
                interestedInTrying: document.querySelector('#section-4 .options-list .option-item.selected')?.dataset.value,
                contactInfo: {}
            };

            // Collect problem ratings
            document.querySelectorAll('#problem-ratings .rating-scale').forEach(scale => {
                const category = scale.querySelector('.rating-option').dataset.category;
                const selected = scale.querySelector('.rating-option.selected');
                response.problemRatings[category] = selected ? selected.dataset.value : null;
            });

            // Collect problem ranking
            document.querySelectorAll('#problem-ranking .ranking-item').forEach((item, index) => {
                response.problemRanking.push({
                    category: item.dataset.category,
                    rank: index + 1
                });
            });

            // Collect contact info if interested
            if (response.interestedInTrying === 'yes') {
                response.contactInfo = {
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value
                };
            }

            return response;
        }

        function saveSurveyResponse(response) {
            let responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            responses.push(response);
            localStorage.setItem('surveyResponses', JSON.stringify(responses));
        }

        function loadDashboard() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            
            // Update statistics
            document.getElementById('total-responses').textContent = responses.length;
            document.getElementById('completion-rate').textContent = responses.length > 0 ? '100%' : '0%';
            
            // If we have responses, process them
            if (responses.length > 0) {
                const processedData = processSurveyData(responses);
                updateDashboardCharts(processedData);
                updateDashboardInsights(processedData);
                populateResponseTable(responses);
            } else {
                // Show empty state
                document.getElementById('avg-problem-severity').textContent = '0.0';
                document.getElementById('top-problem').textContent = '-';
                document.getElementById('solution-interest').textContent = '0%';
                
                // Clear charts or show empty state
                clearCharts();
            }
        }

        function processSurveyData(responses) {
            if (responses.length === 0) return null;
            
            // Process actual data from responses
            const processedData = {
                totalResponses: responses.length,
                completionRate: 100, // Since all are submitted
                // Add actual data processing logic here
                // For now, using sample data structure
                avgProblemSeverity: 3.8,
                topProblem: "Food/Nutrition",
                solutionInterest: 78.3,
                
                problemDistribution: {
                    "Food/Nutrition": 68,
                    "Money/Expenses": 52,
                    "Transport": 45,
                    "Academics": 38,
                    "Mental Health": 32,
                    "Housing": 28,
                    "Social Life": 25,
                    "Safety": 18,
                    "Clothing": 15,
                    "Opportunities": 12
                },
                
                topProblems: {
                    "Food/Nutrition": 142,
                    "Money/Expenses": 118,
                    "Transport": 95,
                    "Academics": 87,
                    "Mental Health": 76
                },
                
                severityByCategory: {
                    "Food/Nutrition": 4.2,
                    "Money/Expenses": 4.1,
                    "Transport": 3.9,
                    "Academics": 3.7,
                    "Mental Health": 3.6,
                    "Housing": 3.4,
                    "Social Life": 3.2,
                    "Safety": 3.1,
                    "Clothing": 2.9,
                    "Opportunities": 2.7
                },
                
                preferredSolutions: {
                    "Cheaper healthy food delivery": 98,
                    "Student ride-sharing": 76,
                    "Study/notes marketplace": 65,
                    "Mental health support": 58,
                    "Side hustles & job matching": 52,
                    "Campus social hub": 47,
                    "Housing marketplace": 41,
                    "Safety alert system": 36
                },
                
                satisfaction: {
                    "Very Dissatisfied": 45,
                    "Dissatisfied": 68,
                    "Neutral": 52,
                    "Satisfied": 42,
                    "Very Satisfied": 40
                },
                
                frustrationFactors: {
                    "Too expensive": 125,
                    "Not reliable": 87,
                    "Time-consuming": 76,
                    "Not available when needed": 64,
                    "Doesn't solve the problem": 53
                },
                
                adoptionLikelihood: {
                    "Very Unlikely": 23,
                    "Unlikely": 35,
                    "Neutral": 52,
                    "Likely": 78,
                    "Very Likely": 59
                },
                
                willingnessToPay: {
                    "Up to R30 per week": 87,
                    "Up to R80 per week": 95,
                    "Up to R150 per week": 48,
                    "More, if it really works": 17
                },
                
                earlyAdopter: {
                    "Yes": 193,
                    "No": 54
                }
            };
            
            return processedData;
        }

        function updateDashboardCharts(data) {
            // Problem Distribution Chart
            createProblemDistributionChart(data.problemDistribution);
            
            // Top Problems Chart
            createTopProblemsChart(data.topProblems);
            
            // Severity by Category Chart
            createSeverityByCategoryChart(data.severityByCategory);
            
            // Preferred Solutions Chart
            createPreferredSolutionsChart(data.preferredSolutions);
            
            // Satisfaction Chart
            createSatisfactionChart(data.satisfaction);
            
            // Frustration Chart
            createFrustrationChart(data.frustrationFactors);
            
            // Adoption Likelihood Chart
            createAdoptionLikelihoodChart(data.adoptionLikelihood);
            
            // Willingness to Pay Chart
            createWillingnessPayChart(data.willingnessToPay);
            
            // Early Adopter Chart
            createEarlyAdopterChart(data.earlyAdopter);
        }

        function clearCharts() {
            // Clear all chart canvases
            const canvases = document.querySelectorAll('canvas');
            canvases.forEach(canvas => {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            });
        }

        function createProblemDistributionChart(data) {
            const ctx = document.getElementById('problem-distribution-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            let config = {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: [
                            '#4361ee', '#3a0ca3', '#4cc9f0', '#f72585', '#7209b7',
                            '#4895ef', '#560bad', '#b5179e', '#480ca8', '#3f37c9'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: window.innerWidth <= 768 ? 'bottom' : 'right',
                        },
                        title: {
                            display: true,
                            text: 'Problem Category Distribution'
                        }
                    }
                }
            };
            
            new Chart(ctx, config);
        }

        function createTopProblemsChart(data) {
            const ctx = document.getElementById('top-problems-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Times Ranked in Top 3',
                        data: chartData,
                        backgroundColor: '#f72585',
                        borderColor: '#b5179e',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Top Problem Areas'
                        }
                    }
                }
            });
        }

        function createSeverityByCategoryChart(data) {
            const ctx = document.getElementById('severity-by-category-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Average Severity (1-5)',
                        data: chartData,
                        backgroundColor: '#4361ee',
                        borderColor: '#3a0ca3',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Problem Severity by Category'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            title: {
                                display: true,
                                text: 'Severity Rating'
                            }
                        }
                    }
                }
            });
        }

        function createPreferredSolutionsChart(data) {
            const ctx = document.getElementById('preferred-solutions-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Number of Preferences',
                        data: chartData,
                        backgroundColor: '#4361ee',
                        borderColor: '#3a0ca3',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Preferred Solutions'
                        }
                    }
                }
            });
        }

        function createSatisfactionChart(data) {
            const ctx = document.getElementById('satisfaction-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: [
                            '#dc3545', '#fd7e14', '#ffc107', '#20c997', '#198754'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Current Solution Satisfaction'
                        }
                    }
                }
            });
        }

        function createFrustrationChart(data) {
            const ctx = document.getElementById('frustration-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: labels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: [
                            '#4361ee', '#3a0ca3', '#4cc9f0', '#f72585', '#7209b7'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Frustration Factors with Current Solutions'
                        }
                    }
                }
            });
        }

        function createAdoptionLikelihoodChart(data) {
            const ctx = document.getElementById('adoption-likelihood-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Number of Responses',
                        data: chartData,
                        backgroundColor: '#20c997',
                        borderColor: '#198754',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Solution Adoption Likelihood'
                        }
                    }
                }
            });
        }

        function createWillingnessPayChart(data) {
            const ctx = document.getElementById('willingness-pay-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: [
                            '#4cc9f0', '#4361ee', '#3a0ca3', '#7209b7'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Willingness to Pay for Solutions'
                        }
                    }
                }
            });
        }

        function createEarlyAdopterChart(data) {
            const ctx = document.getElementById('early-adopter-chart').getContext('2d');
            const labels = Object.keys(data);
            const chartData = Object.values(data);
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: ['#198754', '#dc3545'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Early Adopter Potential'
                        }
                    }
                }
            });
        }

        function updateDashboardInsights(data) {
            // Most pressing issue insight
            document.getElementById('most-pressing-insight').textContent = 
                `"${data.topProblem}" is the most frequently reported problem, with ${data.problemDistribution[data.topProblem]} students identifying it as a major challenge.`;
            
            // Willingness to pay insight
            const topWillingness = Object.entries(data.willingnessToPay).reduce((a, b) => a[1] > b[1] ? a : b);
            document.getElementById('willingness-pay-insight').textContent = 
                `Most students (${topWillingness[1]}) are willing to pay "${topWillingness[0]}" for solutions to their problems.`;
            
            // Early adopter insight
            const earlyAdopterPercent = (data.earlyAdopter.Yes / (data.earlyAdopter.Yes + data.earlyAdopter.No) * 100).toFixed(1);
            document.getElementById('early-adopter-insight').textContent = 
                `${earlyAdopterPercent}% of respondents would try new solutions even if their friends haven't, indicating strong early adopter potential.`;
        }

        function populateResponseTable(responses) {
            const tableBody = document.getElementById('response-table-body');
            tableBody.innerHTML = '';
            
            // Sample data for demonstration
            const sampleResponses = [
                { id: 1, date: "2023-01-05", topProblem: "Food/Nutrition", severity: 4, preferredSolution: "Cheaper healthy food delivery", willingnessToPay: "Up to R80 per week", earlyAdopter: "Yes" },
                { id: 2, date: "2023-01-07", topProblem: "Money/Expenses", severity: 5, preferredSolution: "Side hustles & job matching", willingnessToPay: "Up to R30 per week", earlyAdopter: "Yes" },
                { id: 3, date: "2023-01-12", topProblem: "Transport", severity: 3, preferredSolution: "Student ride-sharing", willingnessToPay: "Up to R80 per week", earlyAdopter: "No" }
            ];
            
            sampleResponses.forEach(response => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${response.id}</td>
                    <td>${response.date}</td>
                    <td>${response.topProblem}</td>
                    <td>${response.severity}/5</td>
                    <td>${response.preferredSolution}</td>
                    <td>${response.willingnessToPay}</td>
                    <td>${response.earlyAdopter}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        function exportData() {
            // Get responses from localStorage
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            
            if (responses.length === 0) {
                alert('No data to export');
                return;
            }
            
            // Convert to CSV
            const headers = ['ID', 'Timestamp', 'Open Ended Problem'];
            const csvRows = [headers.join(',')];
            
            responses.forEach(response => {
                const row = [
                    response.id,
                    response.timestamp,
                    `"${response.openEndedProblem}"`
                ];
                csvRows.push(row.join(','));
            });
            
            const csvString = csvRows.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            
            // Create download link
            const a = document.createElement('a');
            a.href = url;
            a.download = 'survey_responses.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize device ID on first load
        if (!localStorage.getItem('deviceId')) {
            localStorage.setItem('deviceId', TeamApp.generateId());
        }
    </script>
</body>
</html>